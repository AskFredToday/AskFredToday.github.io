riot.tag2("af-collapsible",'<ul><li each="{header, i in headers}" class="{is-active : header.isOpen && header.children}"><af-raw class="{header : true, is-focused : header.isFocused}" text="{header.title}" onclick="{parent.toggleHeader}"></af-raw><af-raw class="body" text="{header.body}" if="{header.body}"></af-raw><af-collapsible class="body" headers="{header.children}" if="{header.children}" bus="{parent.opts.bus}" multiple="{parent.opts.multiple}"></af-collapsible></li></ul>',"","",function(e){var r=this;if(r.headers=e.headers,!r.opts.multiple)for(var a=0,s=r.headers.length;a<s;++a)if(r.headers[a].isOpen){r.current=r.headers[a];break}this.toggleHeader=function(e){r.opts.multiple||(r.current&&r.current!==e.item.header&&(r.current.isOpen=!1,r.current.isFocused=!1),r.current=e.item.header),e.item.header.isOpen=!e.item.header.isOpen,e.item.header.isFocused=!0,r.opts.bus&&r.opts.bus.trigger("headerchanged",e.item.header)},e.bus&&e.bus.on("headerchanged",function(e){for(var a,s=0,i=r.headers.length;s<i;++s)if(a=r.headers[s],a.isFocused&&a!=e){r.headers[s].isFocused=!1,r.update();break}})});