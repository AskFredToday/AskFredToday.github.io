riot.tag2("af-spread","<div></div>","","",function(e){var t=this,o=new EventSource(e.rootpath+"/sse"+e.subpath);o.onopen=function(){console.log("on open")},o.onerror=function(){console.log("on error")},o.onmessage=function(t){var n=t.data.split("\n"),s=n.shift().split("/"),a=(n.shift(),new Date(parseInt(n.shift(),10)),n.join("\n"));e.bus&&e.bus.trigger("spreadEvent",s,a),"CLOSE"==t.id&&o.close()},e.bus&&e.bus.on("postToSpread",function(e,o){var n=new XMLHttpRequest;n.open("POST",t.opts.rootpath+"/raw"+e,!0),n.onreadystatechange=function(e){4==n.readyState&&200==n.status&&console.log(n.responseText)},n.setRequestHeader("Content-Type","text/plain"),n.setRequestHeader("Authorization","Bearer FRED"),n.send(o)})});