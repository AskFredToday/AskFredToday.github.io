riot.tag2("af-timepicker",'<af-select label="{opts.label + ⁗ date⁗}" initvalue="{day}" options="{availableDays}" bus="{dayBus}"></af-select><af-input label="{opts.label + ⁗ time⁗}" initvalue="{time}" bus="{timeBus}"></af-input>',"","",function(e){function t(e){return e<10&&(e="0"+e),e}function a(){n.day={title:u(n.currentvalue)},n.time=r(n.currentvalue),n.timeBus.trigger("setValue",n.time),n.dayBus.trigger("setValue",n.day)}function u(e){return s[e.getDay()]+" "+e.getDate()+" "+l[e.getMonth()]}function r(e){return t(e.getHours())+":"+t(e.getMinutes())}var n=this;n.availableDays=[];for(var s=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],l=["January","February","March","April","May","June","July","August","September","October","November","December"],i=new Date(e.max.valueOf());i>e.min;)n.availableDays.push({id:i,title:u(i)}),i=new Date(i.valueOf()-864e5);e.bus&&e.bus.on("newValue",function(e){n.currentvalue=new Date(e),a()}),this.dayBus=riot.observable(),this.dayBus.fred=!0,this.dayBus.on("newValue",function(e){console.log(e);var t=e.id;n.currentvalue.setFullYear(t.getFullYear()),n.currentvalue.setMonth(t.getMonth()),n.currentvalue.setDate(t.getDate()),n.opts.bus&&n.opts.bus.trigger("value",n.currentvalue)}),this.timeBus=riot.observable(),this.timeBus.on("newValue",function(e,t){console.log(t);var u=t.split(":");if(u.length>1){var r=parseInt(u[0],10);n.currentvalue.setHours(r);var s=parseInt(u[1],10);n.currentvalue.setMinutes(s),n.opts.bus&&n.opts.bus.trigger("value",n.currentvalue)}else a()}),this.currentvalue=e.initvalue,a()});